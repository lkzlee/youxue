<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo - MessengerJS</title>
    <script src="js/messenger.js"></script>

</head>
<body>
<div id="output"></div>
<script>
    var messenger = new Messenger('iframe1', 'MessengerDemo'),
            input = document.getElementById('message');

    messenger.listen(function (msg) {
//        var newline = '\n';
//        var text = document.createTextNode(msg + newline);
        document.getElementById('output').innerHTML=msg;
        console.log(document.getElementById('output').firstElementChild.submit());
    });

    messenger.addTarget(window.parent, 'parent');
    messenger.addTarget(window.parent.frames[1], 'iframe2');

    function sendMessage(name) {
        var msg = input.value;
        messenger.targets[name].send("message from iframe1: " + msg);
        input.value = '';
    }

    function sendAll() {
        var msg = input.value;
        messenger.send("message from iframe1: " + msg);
        input.value = '';
    }
</script>
</body>
</html>