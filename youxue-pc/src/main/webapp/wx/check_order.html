<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
    <title>个人中心-结算订单_Camplink</title>
    <link rel="stylesheet" href="css/cssReset.css"/>
    <link rel="stylesheet" href="css/goods_details.css"/>
</head>
<body>
    <header>
        <div class="goods_message">
            <div class="cf"><p class="fl">订单信息</p><p class="fr">订单详情：<span>3412341231</span></p></div>
            <ul>
                <li class="cf">
                    <img src="img/stu.png" alt=""/>
                    <div>
                        <p>暑假假期 美国贵族小学 亲子体验夏令营</p>
                        <p class="price">价格 ¥ <span>1799</span></p>
                    </div>
                </li>
                <li class="end_time">出发时间<span>2016-06-01</span></li>
                <li class="how_long">行程周期<span>5天</span></li>
            </ul>
        </div>
        <div class="goods_count cf">
            <p>购买数量</p>
            <div>
                <span class="sub_button"></span><input  type="text" value="1"><span class="sum_button"></span>
            </div>
        </div>
    </header>
    <section>
        <form action="" method="get">
            <div class="section1">
                <p>出行人信息</p>
                <ul>
                    <li><span>出行人姓名</span><input type="text" name="go_Name1" placeholder="真实姓名"/></li>
                    <li><span>联系电话</span><input type="text" name="go_Name_call1" placeholder="输入手机号"/></li>
                    <li><span>身份证号</span><input type="text" name="go_number1" placeholder="点击输入"/></li>
                    <li><span>联系地址</span><input type="text" name="go_address1" placeholder="点击输入"/></li>
                </ul>
            </div>
            <div class="section2">
                <p>联系人信息</p>
                <ul>
                    <li><span>联系人姓名</span><input type="text" name="us" placeholder="真实姓名"/></li>
                    <li><span>联系电话</span><input type="text" name="us_call" placeholder="输入手机号"/></li>
                    <li><span>邮箱地址</span><input type="text" name="us_address" placeholder="点击输入"/></li>
                </ul>
            </div>
            <div class="section3">
                <p>付款方式</p>
                <ul>
                    <li><img src="img/ic_weixinpay.png" alt=""/><span>优惠编码</span><label class="common_choice " for="pay_weixin"><input id="pay_weixin" type="radio" name="pay_method" checked value="1" style="display:none"/><i class="active"></i></label></li>
                    <li><img src="img/ic_alipay.png" alt=""/><span>支付宝支付</span><label class="common_choice"  for="pay_zhifubao"><input id="pay_zhifubao" type="radio" name="pay_method" value="2" style="display:none"/><i></i></label></li>
                </ul>
            </div>
            <div class="section4">
                <p>优惠编码</p>
                <ul>
                    <li><label class="common_choice" for="no_youhui"><i class="active"></i></label><span>不使用/无优惠码</span><input type="radio" name="youkuima" value="1" checked id="no_youhui" style="display:none"/></li>
                    <li><label class="common_choice" for="youhui"><i></i></label><span>使用优惠码</span><input type="radio" name="youkuima" value="2" id="youhui" style="display:none"/><input type="text" placeholder="点击输入优惠码" style="display: none"/></li>
                </ul>
            </div>
        </form>
    </section>
    <footer class="cf">
        <p>合计：¥ <span>1799</span></p>
        <button>立即支付</button>
    </footer>
    <script src="js/jquery-3.1.0.min.js"></script>
    <script src="js/fastclick.js"></script>
    <script>
        function add_contacts($this,n){     //需要add_contacts添加另一个形参，表示name值，否则无法提交所有表单信息，后期添加。
            for(var i=n;i>0;i--){
                $this.parent().parent().parent().next().children().prepend('<div class="section1"><p>出行人信息</p><ul><li><span>出行人姓名</span><input type="text" name="go_Name'+i+'" placeholder="真实姓名"/></li><li><span>联系电话</span><input type="text" name="go_Name_call'+i+'" placeholder="输入手机号"/></li><li><span>身份证号</span><input type="text" name="go_number'+i+'" placeholder="点击输入"/></li><li><span>联系地址</span><input type="text" name="go_address'+i+'" placeholder="点击输入"/></li></ul></div >');
            }
        }
        function sub_contacts($this){
            $this.parent().parent().parent().next().children().children(".section1:last").remove();
        }
        $(function() {
            FastClick.attach(document.body);
            $(".section3>ul,.section4>ul").on("click",".common_choice",function(){
                $(this).children("i").addClass("active").parent().parent().siblings("li").find("i").removeClass("active");
            });
            $('.goods_count>div').on("click","span",function(){
                if($(this).hasClass("sub_button")){
                    if($(this).parent().find("input").val()==1){
                        return;
                    }else{
                        $(this).parent().find("input").val($(this).parent().find("input").val()-1);
                        sub_contacts($(this));
                    }
                }else{
                    $(this).parent().find("input").val(parseInt($(this).parent().find("input").val())+1);
//                    var section1_number=$(".section1").length+1;
                    var section1_number= $(this).parent().parent().parent().next().find(".section1").length+1;
//                    $('.section1').remove();
                    $(this).parent().parent().parent().next().find(".section1").remove();
                    add_contacts($(this),section1_number);
                }
            });
            $('.goods_count>div>input').on("blur",function(){
//                var temp=parseInt($(this).val());
//                if(/^\d+$/.test(temp)&&temp!=0){
//                    $('.section1').remove();
//                    add_contacts($(this),temp);
//                }else{
//                    $(this).val(1);
//                    $('.section1').remove();
//                    add_contacts($(this),1);
//                }
                var temp=$(this).val();
                if(/^\d+$/.test(Number(temp))&&(Number(temp)>=1)&&!(/\./g.test(temp))){
                    $(this).parent().parent().parent().next().find(".section1").remove();
                    add_contacts($(this),temp);
                }else{
                    $(this).val(1);
                    $(this).parent().parent().parent().next().find(".section1").remove();
                    add_contacts($(this),1);
                }
            });
            $(".section4").on("click","label",function(){
                if($(this).prop("for")=="youhui"){
                    $(this).parent().find("[type=text]").show();
                }else{
                    $(this).parent().next().find("[type=text]").hide();
                }
            })
            $("footer>button").on("click",function(){
                $("form").submit();
            });
            $(".goods_message>ul>li:first").on("click",function(){
                window.location.href="camp_details.html";
            })
        });
    </script>
</body>
</html>